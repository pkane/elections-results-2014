
<% if (race.key === 'initiatives') { %>

    <% if (!state) { %>
    <div class="row house-card-deck">    
        <% _.each(_.sortBy(data, function (obj) { return parseInt(obj.id); }), function(s) { %>

            <a href="#<%= race.key %>-<%= getStateById(s.id).abbr %>">
                <div class="col-xs-4 col-sm-3 col-md-2 col-lg-2 card-item">
                    <div class='card-item-inner'>

                        <span class="card-state-name"><%= s.name.toLowerCase() %></span>
                        <div class="num-races"><%= s.initiatives.length %></div> initiatives
                    </div>
                </div>
            </a>
        <% }); %>
    </div>
    <% } else { %>
        <div class="row-fluid">
        <% _.each(_.sortBy(detail, function(obj) { return findSortValue(obj.name); }), function(value) { %>
            <table class="result-item">
                <thead>
                    <tr class="result-first-row">
                        <th class="district-name" colspan="3">
                            <%= value.name %>
                        </th>
                    </tr>
                </thead>
                <tbody>
                <% _.each(value.results, function(item) { %>
                    <tr class="initiatives">
                        <td class="initiative-name"><%= item.name %></td>
                        <td class="result-votes"><% if (!isMobile) { %><%= formatVotes(item.votes) %> <% };%></td>
                        <td class="result-pct"><%= formatPercent(item.pct/100) %></td>
                    </tr>
                <% }); %>
                </tbody>
            </table>
        <% }); %>
        </div>
    <% } %>

<% } else if (race.key === 'house') { %>

    <% if (!state) { %>
        <div class="row house-card-deck">
            <% _.each(_.chain(data).keys().sortBy(function (id) { return parseInt(id); }).value(), function(stateId) { %>
                <a href="#<%= race.key %>-<%= getStateById(stateId).abbr %>">
                    <div class="col-xs-4 col-sm-3 col-md-2 col-lg-2 card-item">
                        <div class='card-item-inner'>
                            <%= getStateById(stateId).display %>
                            <div class="num-races"><%= data[stateId].length %></div>races
                        </div>
                    </div>
                </a>
            <% }); %>
        </div>
    <% } else { %>

        <div class="row-fluid">
        <% _.each(_.sortBy(detail, function (value) { return parseInt(tokenizeHouseId(value.id)); }), function(value) { %>
            <table class="result-item house-item">
                <thead>
                    <tr class="result-first-row">
                    <th class="district-name">
                        <a href="#race/<%= race.key %>-<%= state.abbr %>-<%= tokenizeHouseId(value.id) %>">
                            <%= formatHouseId(value.id) %>
                        </a>
                    </th>
                    <th class="reporting" colspan="2"><%= Math.round(parseFloat(value.precincts.pct)*100)/100 %>% reporting</th>
                </tr>
                </thead>
                <tbody>
                <% _.each(value.results, function(item) { %>
                    <% var pctVotes = formatPercent(item.votes, value.votes); %>
                    <tr class="candidate <%= item.party.toLowerCase() %><% if (item.win) { %> winner <% } %>">
                        <td class="result-name"><span></span><%= item.name %> <%= formatParty(item.party) %></td>                    
                        <td class="result-votes" style='background-size: <%= pctVotes %>% 100%;'>
                            <% if (!isMobile) { %><%= formatVotes(item.votes) %> <% };%>
                        </td>
                        <td class="result-win"><%= formatPercent(item.votes, value.votes) %></td>                              
                    </tr>
                <% }); %>
                </tbody>
            </table>
        <% }); %>      
        </div>
    <% } %>
<% } else if (race.key === 'senate' || race.key === 'governors') { %>
<div class="row">
    <% _.each(!state ? data : detail, function(value) { %>
        <table class="result-item senate-item">
            <thead>
                <tr class="result-first-row">
                    <th class="district-name" colspan="3">
                        <a href="
                        <% if (!state) { %>
                            #<%= race.key %>-<%= getStateByName(value.name).abbr %>
                        <% } else { %>
                            #<%= race.key %>-<%= state.abbr %>
                        <% } %>
                        ">
                        <%= value.name %><%= getCountyByFips(value.id) %>
                        </a>
                    </th>
                    <th class="reporting" colspan="2"><%= Math.round(parseFloat(value.precincts.pct)*100)/100 %>% reporting</th>
                </tr>
            </thead>
            <tbody>
            <% _.each(_.groupBy(value.results, 'seatNumber'), function(race, index) { %>

                <% if (index > 0) { %>
                    <tr><td colspan="3"><hr /></td></tr>
                <% } %>

                <% _.each(race, function(item) { %>
                <% var pctVotes = formatPercent(item.votes, value.votes); %>
                    <tr class="candidate <%= item.party.toLowerCase() %><% if (item.win) { %> winner <% } %>">
                        <td class="result-name"><span></span><%= item.name %> <%= formatParty(item.party) %></td>                    
<<<<<<< HEAD
                        <td class="result-votes" style='background-size: <%= pctVotes %>% 100%;'>
                            <% if (!isMobile) { %><%= formatVotes(item.votes) %> <% };%> 
=======
                        <td class="result-votes" style='background-size: <%= parseInt(pctVotes) %>% 100%;'>
                            <%= formatVotes(item.votes) %> 
>>>>>>> 1cdc15068b9527ec22c8e4ab729f1e80faf520af
                        </td>
                        <td class="result-win"><%= pctVotes %></td>
                    </tr>
                    
                <% }); %>
            <% }); %>
            </tbody>
        </table>
    <% }); %>
</div>

<% } %>